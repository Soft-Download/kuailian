<html lang="zh-CN">
<head>
  <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
  <meta content="yes" name="apple-mobile-web-app-capable">
  <meta content="yes" name="apple-touch-fullscreen">
  <meta content="black" name="apple-mobile-web-app-status-bar-style">
  <meta content="320" name="MobileOptimized">
  <title>官方认证-安全访问</title>
<style>
/* 加载容器样式 */
.loading-container {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: #f8f9fa;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

/* 安全访问文字样式 */
.security-text {
    font-size: 24px;
    color: #28a745; /* 安全绿 */
    font-weight: bold;
    letter-spacing: 1px;
    margin-bottom: 20px;
    text-align: center;
}

/* 安全图标样式 */
.security-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: #28a745;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 30px;
    margin: 0 auto 15px;
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
}

/* 加载提示文字 */
.loading-tip {
    color: #6c757d;
    font-size: 14px;
    text-align: center;
}

/* 进度条样式 */
.progress-container {
    width: 80%;
    max-width: 400px;
    height: 6px;
    background-color: #e2e8f0;
    border-radius: 3px;
    overflow: hidden;
    margin: 20px 0;
}

.progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #28a745 0%, #4CAF50 100%);
    transition: width 1.5s ease;
}

/* iframe容器样式 */
.content{
    height:100%;
    width:100%;
    position: fixed;
    left: -2px;
    top: -2px;
    border: none;
}
</style>
</head>
<body>

<div class="loading-container" id="loadingContainer">
    <div class="security-icon">✓</div>
    <div class="security-text">官方安全验证</div>
    <div class="loading-tip" id="loadingTip">正在进行安全验证...</div>
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
</div>

<script>
// 页面加载完成后立即开始快速验证流程
window.addEventListener('DOMContentLoaded', function() {
    const progressBar = document.getElementById('progressBar');
    const loadingTip = document.getElementById('loadingTip');
    
    // 立即开始进度条动画
    progressBar.style.width = "100%";
    
    // 1.5秒后更新提示文字
    setTimeout(() => {
        loadingTip.textContent = "验证完成，正在跳转...";
    }, 1500);
    
    // 2秒内完成整个流程
    setTimeout(loadTargetUrl, 2000);
});

// 加载目标URL
function loadTargetUrl() {
    try {
        const urlParams = new URLSearchParams(window.location.search);
        const encodedParam = urlParams.get('c');
        
        if (!encodedParam) {
            throw new Error("缺少访问参数");
        }
        
        // 解码并验证URL
        let tureurl = atob(encodedParam);
        
        // 验证URL合法性
        try {
            new URL(tureurl);
            if (!tureurl.startsWith('http://') && !tureurl.startsWith('https://')) {
                throw new Error("无效的URL协议");
            }
        } catch (e) {
            throw new Error("无效的目标URL: " + e.message);
        }

        // 隐藏加载动画
        document.getElementById("loadingContainer").style.display = "none";

        // 插入iframe
        const html = `<iframe class="content" onload="bindMouseWhee(this)" src="${tureurl}"></iframe>`;
        document.writeln(html);
        
    } catch (e) {
        console.error("加载失败: " + e.message);
        document.getElementById('loadingTip').textContent = "验证失败: " + e.message;
        document.querySelector('.security-text').style.color = "#dc3545";
        document.querySelector('.security-icon').style.backgroundColor = "#dc3545";
        document.querySelector('.security-icon').textContent = "!";
    }
}

// 鼠标滚轮事件处理
var firefox = navigator.userAgent.indexOf('Firefox') != -1;

function MouseWheel(e, doc) {
    try {
        e.preventDefault && e.preventDefault();
        e.returnValue = false;
        var up = firefox && e.detail < 0 || e.wheelDelta > 0;
        doc.body.scrollTop = doc.documentElement.scrollTop += up ? -50 : 50;
    } catch (e) {
        console.log('跨域环境下无法控制滚动:', e);
    }
}

function bindMouseWhee(ifr) {
    try {
        // 检查是否同源
        var isSameOrigin = false;
        try {
            var iframeOrigin = new URL(ifr.src).origin;
            isSameOrigin = window.location.origin === iframeOrigin;
        } catch (e) {
            console.log('无法验证同源性:', e);
        }

        if (isSameOrigin) {
            var doc = ifr.contentWindow.document;
            if (firefox) {
                doc.addEventListener('DOMMouseScroll', function(e) {
                    MouseWheel(e, doc);
                }, false);
            } else {
                doc.onmousewheel = function(e) {
                    MouseWheel(e || ifr.contentWindow.event, doc);
                };
            }
        } else {
            console.log('检测到跨域iframe，将不绑定滚动事件以避免安全错误');
        }
    } catch (e) {
        console.log('绑定滚动事件失败:', e);
    }
}
</script>
</body>
</html>
